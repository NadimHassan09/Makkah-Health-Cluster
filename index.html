<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>برنامج سفراء التميز المؤسسي</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    * { font-family: 'Tajawal', sans-serif; }
    body { box-sizing: border-box; }

    :root{
      --p:#2C4E8B;     /* Primary */
      --s:#218088;     /* Secondary */
      --a:#80D4D6;     /* Accent */
      --w:#ffffff;
      --ink:#0f172a;
    }

    /* ========== GLOBAL BACKGROUND (full gradient) ========== */
    .site-bg{
      background: linear-gradient(135deg, rgba(44,78,139,1) 0%, rgba(33,128,136,1) 55%, rgba(128,212,214,1) 120%);
      min-height: 100%;
    }
    .site-overlay{
      background: rgba(255,255,255,0.70);
      min-height: 100%;
    }

    /* ========== HERO (full screen) ========== */
    .hero-gradient{
      background: linear-gradient(
        135deg,
        rgba(44,78,139,0.86) 0%,
        rgba(33,128,136,0.82) 55%,
        rgba(128,212,214,0.78) 120%
      );
    }
    .hero-shine{
      position:absolute;
      inset:0;
      background:
        radial-gradient(1000px 420px at 18% 40%, rgba(255,255,255,.10), transparent 62%),
        radial-gradient(900px 520px at 80% 30%, rgba(255,255,255,.10), transparent 62%);
      pointer-events:none;
    }
    /* ===== HERO poster background layer ===== */
    .hero-poster-bg{
      position:absolute;
      inset:0;
      background-image: url("poster.png");
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;          /* fill hero nicely */
      opacity: 0.22;                   /* adjust visibility */
      filter: saturate(1.05) contrast(1.02);
      pointer-events:none;
      z-index: 0;
    }
    /* optional: add a soft glass veil to keep readability */
    .hero-poster-veil{
      position:absolute;
      inset:0;
      background: rgba(255,255,255,0.10); /* subtle bright veil */
      pointer-events:none;
      z-index: 1;
    }
    /* keep existing hero layers ordered correctly */
    header.hero-gradient{
      position: relative;
      overflow: hidden;
    }
    /* make sure content is always above poster + veils */
    header.hero-gradient .hero-shine{ z-index: 2; }
    header.hero-gradient .net-wrap{ z-index: 3; }
    header.hero-gradient .max-w-6xl{ z-index: 4; position: relative; }

    /* Mobile: reduce poster visibility to keep clarity on small screens */
    @media (max-width: 640px){
      .hero-poster-bg{ opacity: 0.16; background-position: center top; }
      .hero-poster-veil{ background: rgba(255,255,255,0.14); }
    }

    @media (prefers-reduced-motion: reduce){
      .hero-poster-bg{ filter: none; }
    }

    /* ========== NETWORK CANVAS (fixed continuous motion) ========== */
    .net-wrap{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0.48;
      mix-blend-mode: screen;
      filter: blur(0px);
    }
    canvas.net-canvas{ width:100%; height:100%; display:block; }

    /* ========== NAV BUTTONS ========== */
    .tab-btn{
      border: 1px solid rgba(15,23,42,.08);
      background: rgba(255,255,255,.78);
      color: rgba(15,23,42,.75);
      transition: all .18s ease;
    }
    .tab-btn:hover{
      background: rgba(255,255,255,.95);
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(2,6,23,.06);
      color: rgba(15,23,42,.92);
    }
    .tab-active{
      background: linear-gradient(135deg, rgba(44,78,139,1) 0%, rgba(33,128,136,1) 100%);
      color:#fff !important;
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 16px 30px rgba(44,78,139,.18);
    }
    .tab-active:hover{
      color:#fff !important;
      background: linear-gradient(135deg, rgba(44,78,139,1) 0%, rgba(33,128,136,1) 100%);
      transform: none;
    }

    /* ========== LIST WRAP TRANSITION (no harsh disappear) ========== */
    .list-anim{
      transition: opacity .35s ease, transform .35s ease, filter .35s ease;
      will-change: opacity, transform;
    }
    .list-anim.is-switching{
      opacity: 0;
      transform: translateY(10px);
      filter: blur(2px);
    }

    /* ========== TIMELINE ========== */
    .timeline{
      position: relative;
      padding: 34px 0 16px;
    }

    .t-item{
      position: relative;
      display:flex;
      justify-content:center;
      align-items: stretch;
      margin: 18px 0;
      gap: 0;
    }

    /* ========== CARD ========== */
    .t-card{
      width: min(980px, 100%);
      margin: 0;
      background: rgba(255,255,255,.94);
      border: 1px solid rgba(15,23,42,.08);
      border-radius: 18px;
      overflow:hidden;
      box-shadow: 0 18px 40px rgba(2,6,23,.08);
      transition: transform .22s ease, box-shadow .22s ease, border-color .22s ease;
      cursor: pointer;
      position: relative;
      z-index: 1;
    }
    /* Top accent strip (solid brand color, no gradient) */
    .t-card::before{
      content:"";
      position:absolute;
      top:0;
      left:0;
      right:0;
      height: 8px;
      background: var(--p);
      border-top-left-radius: 18px;
      border-top-right-radius: 18px;
      pointer-events:none;
      z-index: 0;
    }
    .t-card:hover{
      transform: translateY(-3px);
      box-shadow: 0 24px 54px rgba(2,6,23,.10);
      border-color: rgba(44,78,139,.18);
    }
    .t-card.active{
      border-color: rgba(128,212,214,.65);
      box-shadow: 0 28px 62px rgba(33,128,136,.16);
    }

    /* ✅ (تم إبقاء الأيقونة الخلفية للـ Card مثل ما هي) */
    .card-icon-bg{
      position:absolute;
      left:-30px;
      top:-30px;
      width: 160px;
      height: 160px;
      opacity: .12;
      color: rgba(44,78,139,1);
      pointer-events:none;
      transform: rotate(-8deg);
    }

    /* ✅ محتوى الكارد في النص عموديًا */
    .card-head{
      padding: 12px 14px 10px;
      position: relative;
      z-index: 1;
      min-height: auto;
    }
    .card-main{
      display:grid;
      grid-template-columns: 1fr;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .card-text-col{
      display:flex;
      flex-direction:column;
      gap: 6px;
      min-width: 0;
    }
    .card-text-top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
    }
    .card-text-shift{
      transition: transform .25s ease;
    }
    .t-card.open .card-text-shift{
      transform: translateX(-10px);
    }
    .head-icon{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      border: 1px solid rgba(44,78,139,.35);
      background: rgba(44,78,139,.08);
      color: var(--p);
      flex-shrink: 0;
    }
    .details-grid{
      display:grid;
      grid-template-columns: 1fr 1.2fr;
      gap: 16px;
      align-items: start;
    }
    .details-media{
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: 0 14px 28px rgba(2,6,23,.08);
      background: rgba(255,255,255,.7);
    }
    .details-media img{
      width: 100%;
      height: 100%;
      min-height: 280px;
      object-fit: cover;
      display:block;
    }
    .card-text{
      display:flex;
      flex-direction:column;
      justify-content:center;
      min-height: auto;
      min-width: 0;
    }

    .card-meta{
      font-size: 12px;
      font-weight: 800;
      color: rgba(15,23,42,.52);
      line-height: 1.2;
    }
    .meta-row{
      display:flex;
      align-items:center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
      font-weight: 900;
      line-height: 1;
      white-space: nowrap;
    }
    .pill-session{
      background: var(--p);
      color: #fff;
      box-shadow: 0 10px 22px rgba(44,78,139,.14);
    }
    .pill-phase{
      background: rgba(44,78,139,.08);
      color: var(--p);
      border: 1px solid rgba(44,78,139,.25);
    }
    .card-title{
      margin-top: 2px;
      font-size: 18px;
      font-weight: 900;
      color: rgba(15,23,42,.92);
      line-height: 1.35;
    }
    .card-sub{
      margin-top: 2px;
      font-size: 13px;
      font-weight: 800;
      color: rgba(15,23,42,.55);
    }

    /* Chevron */
    .chev{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(15,23,42,.04);
      border: 1px solid rgba(15,23,42,.06);
      transition: transform .25s ease, background .25s ease;
      flex-shrink:0;
    }
    .t-card:hover .chev{ background: rgba(15,23,42,.06); }
    .chev svg{
      width: 22px;
      height: 22px;
      color: rgba(44,78,139,.85);
      transition: transform .25s ease;
    }
    .t-card.open .chev svg{ transform: rotate(180deg); }

    /* Details list check */
    .bullet-check{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background: rgba(44,78,139,.12);
      border: 1px solid rgba(44,78,139,.30);
      color: var(--p);
      flex-shrink: 0;
      margin-top: 2px;
    }
    .bullet-check svg{
      width: 12px;
      height: 12px;
      display:block;
      stroke: currentColor;
      stroke-width: 3;
    }

    /* Details */
    .details{
      border-top: 1px solid rgba(15,23,42,.06);
      background: rgba(255,255,255,.78);
      max-height: 0;
      overflow: hidden;
      transition: max-height .35s ease;
    }
    .t-card.open .details{ max-height: 520px; }


    /* Responsive */
    @media (max-width: 980px){
      .t-item{ margin: 18px 0; }
      .t-card{ width: min(980px, 100%); }
    }
    @media (max-width: 640px){
      .card-text-top{ flex-wrap: wrap; }
      .details-grid{ grid-template-columns: 1fr; }
      .details-media img{ min-height: 180px; }
    }

    /* scroll */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: var(--s); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--p); }

    /* ========== SCROLL PROGRESS BAR (modern, hero gradient) ========== */
    .scroll-progress{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      width: min(980px, calc(100vw - 28px));
      height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow:
        0 14px 34px rgba(2,6,23,.22),
        0 6px 16px rgba(2,6,23,.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      overflow: hidden;
      z-index: 9999;
      pointer-events: none;
    }

    .scroll-progress__bar{
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(44,78,139,1) 0%, rgba(33,128,136,1) 55%, rgba(128,212,214,1) 120%);
      box-shadow:
        0 10px 26px rgba(33,128,136,.35),
        0 0 0 1px rgba(255,255,255,.10) inset;
      transform-origin: left center;
      transition: width .12s linear;
      position: relative;
      overflow: hidden;
    }

    /* subtle moving shine */
    .scroll-progress__bar::after{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,.28) 50%, transparent 100%);
      transform: translateX(-60%);
      opacity: .65;
      animation: progressShine 1.6s ease-in-out infinite;
    }

    @keyframes progressShine{
      0%   { transform: translateX(-60%); }
      100% { transform: translateX(160%); }
    }

    /* optional: hide when at very top */
    .scroll-progress.is-zero{
      opacity: .35;
      transform: translateX(-50%) translateY(4px);
      filter: saturate(.9);
    }

    /* reduced motion */
    @media (prefers-reduced-motion: reduce){
      .scroll-progress__bar{ transition: none; }
      .scroll-progress__bar::after{ animation: none; }
    }

    .poster-section{
      padding: 18px 0 4px;
    }
    .poster-card{
      width: min(980px, 100%);
      margin: 0 auto;
      background: rgba(255,255,255,.88);
      border: 1px solid rgba(15,23,42,.10);
      border-radius: 22px;
      overflow: hidden;
      box-shadow:
        0 24px 60px rgba(2,6,23,.10),
        0 10px 26px rgba(2,6,23,.06);
      position: relative;
    }
    .poster-card::before{
      content:"";
      position:absolute;
      top:0; left:0; right:0;
      height: 8px;
      background: linear-gradient(135deg, rgba(44,78,139,1) 0%, rgba(33,128,136,1) 55%, rgba(128,212,214,1) 120%);
      opacity: .95;
    }
    .poster-body{
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      padding: 18px 18px 16px;
    }
    .poster-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding-top: 6px;
    }
    .poster-title{
      font-weight: 900;
      color: rgba(15,23,42,.88);
      font-size: 16px;
    }
    .poster-badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 900;
      background: rgba(44,78,139,.08);
      color: rgba(44,78,139,1);
      border: 1px solid rgba(44,78,139,.22);
      white-space: nowrap;
    }
    .poster-frame{
      background: rgba(255,255,255,.65);
      border: 1px solid rgba(15,23,42,.08);
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 14px 28px rgba(2,6,23,.06);
    }
    .poster-img{
      width: 100%;
      height: auto;
      display:block;
      object-fit: contain;
      max-height: 420px;
    }
    .poster-hint{
      font-size: 12px;
      font-weight: 700;
      color: rgba(15,23,42,.55);
      margin-top: 2px;
    }

    @media (min-width: 980px){
      .poster-body{ padding: 20px 22px 18px; }
      .poster-img{ max-height: 460px; }
    }
  </style>

  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
</head>

<body class="h-full">
  <div id="scrollProgress" class="scroll-progress" aria-hidden="true">
    <div class="scroll-progress__bar"></div>
  </div>
  <div id="app-wrapper" class="h-full w-full overflow-auto site-bg">
    <div class="site-overlay">

      <!-- HERO: full height -->
      <header class="hero-gradient text-white relative overflow-hidden min-h-screen flex items-center">
        <div class="hero-poster-bg" aria-hidden="true"></div>
        <div class="hero-poster-veil" aria-hidden="true"></div>
        <div class="hero-shine"></div>

        <div class="net-wrap">
          <canvas id="heroNetwork" class="net-canvas"></canvas>
        </div>

        <div class="max-w-6xl mx-auto w-full px-4 relative z-10">
          <div class="flex items-center justify-center mb-8">
            <!-- ✅ تكبير اللوجو ~15% -->
            <img src="logo.png" alt="شعار تجمع مكة المكرمة الصحي" class="h-[138px] md:h-[222px] w-auto drop-shadow-[0_14px_26px_rgba(0,0,0,0.18)]" />
          </div>

          <div class="text-center">
            <div class="inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 mb-5">
              <svg class="w-5 h-5 text-white/90" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
              </svg>
              <span class="text-sm font-bold" id="sessions-badge">16 لقاءً تدريبياً</span>
            </div>

            <h1 id="program-title" class="text-3xl md:text-6xl font-extrabold mb-4 tracking-tight whitespace-nowrap">
              البرنامج التدريبي لسفراء التميز المؤسسي
            </h1>

            <p class="mt-3 text-white/90 max-w-3xl mx-auto text-sm md:text-lg">
              برنامج شامل لبناء قدرات سفراء التميز المؤسسي في تجمع مكة المكرمة الصحي
            </p>

            <div class="mt-10 flex items-center justify-center">
              <button onclick="scrollToContent()"
                class="inline-flex items-center gap-2 bg-white/18 hover:bg-white/22 border border-white/20 px-6 py-3 rounded-2xl font-extrabold backdrop-blur-sm transition">
                استعراض اللقاءات
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- NAV -->
      <nav id="filters" class="sticky top-0 z-50 border-b border-white/30 bg-white/75 backdrop-blur-md shadow-sm">
        <div class="max-w-6xl mx-auto px-4">
          <div class="flex gap-2 py-3 overflow-x-auto justify-center">
            <button onclick="showPhase('all')" id="tab-all"
              class="tab-btn tab-active px-4 py-2 rounded-xl font-extrabold text-sm whitespace-nowrap">
              جميع اللقاءات
            </button>
            <button onclick="showPhase(1)" id="tab-1"
              class="tab-btn px-4 py-2 rounded-xl font-extrabold text-sm whitespace-nowrap">
              التأسيسية
            </button>
            <button onclick="showPhase(2)" id="tab-2"
              class="tab-btn px-4 py-2 rounded-xl font-extrabold text-sm whitespace-nowrap">
              بناء المفاهيم
            </button>
            <button onclick="showPhase(3)" id="tab-3"
              class="tab-btn px-4 py-2 rounded-xl font-extrabold text-sm whitespace-nowrap">
              التقييم والنتايج
            </button>
            <button onclick="showPhase(4)" id="tab-4"
              class="tab-btn px-4 py-2 rounded-xl font-extrabold text-sm whitespace-nowrap">
              التطبيق العملي
            </button>
          </div>
        </div>
      </nav>

      <main class="max-w-6xl mx-auto px-4 py-10">
        <div id="timelineWrap" class="list-anim">
          <div id="timeline" class="timeline"></div>
        </div>
      </main>

      <footer class="hero-gradient text-white py-8 px-4 mt-6 relative overflow-hidden">
        <div class="net-wrap" style="opacity:.26">
          <canvas id="footerNetwork" class="net-canvas"></canvas>
        </div>

        <div class="max-w-6xl mx-auto text-center relative z-10">
          <div class="flex items-center justify-center gap-2 mb-3">
            <svg class="w-6 h-6 text-white/90" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
            <span class="font-extrabold text-lg">سفراء التميز المؤسسي</span>
            <svg class="w-6 h-6 text-white/90" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
          </div>

          <p class="text-white/90 text-sm">
            ادارة التميز المؤسسي - ادارة الجودة والاعتماد - الادارة التنفيذية للجودة والأداء
          </p>
        </div>
      </footer>

    </div>
  </div>

  <script>
    const defaultConfig = {
      program_title: 'البرنامج التدريبي لسفراء التميز المؤسسي',
      sessions_count: '16 لقاءً',
      primary_color: '#2C4E8B',
      secondary_color: '#218088',
      accent_color: '#80D4D6',
      text_color: '#0f172a',
      background_color: '#ffffff'
    };

    /* ===================== ICONS ===================== */
    /* ✅ تم تعطيل أيقونات "كل لقاء" بالكامل (ترجع فارغة) */
    function iconSvg(key) { return ''; }

    /* ===================== DATA ===================== */
    const sessions = [
      { id: 1,  phase: 1, title: 'انطلاق المبادرة ومدخل إلى التميز المؤسسي', iconKey: 'kickoff', imageUrl: '', topics: [
        'إطلاق مبادرة سفراء التميز المؤسسي','مفهوم التميز المؤسسي في القطاع الصحي','الفرق بين التحسين التشغيلي والتميز المؤسسي الشامل','دور سفراء التميز في دعم التحول المؤسسي'
      ]},
      { id: 2,  phase: 1, title: 'نظم الإدارة (ISO) ودورها الداعم للتميز التشغيلي', iconKey: 'iso', imageUrl: '', topics: [
        'مفهوم نظم الإدارة وفق ISO','دور ISO في توحيد الممارسات وتحسين الأداء التشغيلي','العلاقة بين نظم الإدارة ونماذج التميز المؤسسي','الممكنات التي يدعمها ISO وحدود دوره'
      ]},
      { id: 3,  phase: 1, title: 'نموذج جائزة الملك عبدالعزيز للجودة (KAQA)', iconKey: 'award', imageUrl: '', topics: [
        'فلسفة الجائزة ومنطقها','هيكل النموذج والمعايير','متطلبات الجائزة مقابل التطبيق المؤسسي','موقع KAQA بين نماذج التميز العالمية'
      ]},
      { id: 4,  phase: 1, title: 'مكونات نماذج التميز المؤسسي', iconKey: 'framework', imageUrl: '', topics: [
        'فلسفة نماذج التميز ولماذا وُجدت','الممكنات مقابل النتائج','التكامل بين القيادة، الاستراتيجية، العمليات، والنتائج','موقع KAQA ضمن منظومة التميز المؤسسي'
      ]},
      { id: 5,  phase: 2, title: 'معيار القيادة', iconKey: 'leadership', imageUrl: '', topics: [
        'الحوكمة والتوجيه المؤسسي','دور القيادة في بناء ثقافة التميز','المساءلة ومتابعة الأداء','أمثلة تطبيقية من القطاع الصحي'
      ]},
      { id: 6,  phase: 2, title: 'معيار الاستراتيجية', iconKey: 'strategy', imageUrl: '', topics: [
        'بناء الاستراتيجية المؤسسية','مواءمة الاستراتيجية مع احتياجات أصحاب المصلحة','ترجمة الاستراتيجية إلى مبادرات ومؤشرات','متابعة التنفيذ وقياس الأثر'
      ]},
      { id: 7,  phase: 2, title: 'معيار الموارد البشرية', iconKey: 'people', imageUrl: '', topics: [
        'التمكين وبناء القدرات','تخطيط القوى العاملة','إدارة الأداء والتطوير','نتائج الموارد البشرية وأثرها المؤسسي'
      ]},
      { id: 8,  phase: 2, title: 'معيار الشراكات والموارد', iconKey: 'partners', imageUrl: '', topics: [
        'إدارة الشراكات الاستراتيجية','إدارة الموارد المالية والتقنية','إدارة المخاطر والاستدامة','استمرارية الأعمال'
      ]},
      { id: 9,  phase: 2, title: 'معيار العمليات', iconKey: 'process', imageUrl: '', topics: [
        'تصميم وإدارة العمليات المؤسسية','رفع الكفاءة والفعالية','ربط العمليات بتجربة المستفيد','التحسين المستمر'
      ]},
      { id: 10, phase: 3, title: 'معيار نتائج المستفيد', iconKey: 'beneficiary', imageUrl: '', topics: [
        'قياس رضا المستفيد','إدارة الشكاوى والتغذية الراجعة','تحليل الاتجاهات والمؤشرات','ربط النتائج بالممكنات'
      ]},
      { id: 11, phase: 3, title: 'معيار نتائج الموارد البشرية', iconKey: 'metrics', imageUrl: '', topics: [
        'رضا ومشاركة الموظفين','الاستقرار الوظيفي','تحليل نتائج الموارد البشرية','الربط بالقيادة والتمكين'
      ]},
      { id: 12, phase: 3, title: 'معيار نتائج الأداء المؤسسي', iconKey: 'metrics', imageUrl: '', topics: [
        'مؤشرات الأداء المؤسسية','الاتجاهات والمقارنات المرجعية','الاستدامة','القراءة الشاملة للنتائج'
      ]},
      { id: 13, phase: 3, title: 'منهجية التقييم والتقارير', iconKey: 'report', imageUrl: '', topics: [
        'أداة إتقان (النظام – الإنفاذ – القياس – التطوير)','المسطرة التقييمية ومعايير الدرجات','صياغة نقاط القوة وفرص التحسين بلغة KAQA','إعداد التقارير التقييمية'
      ]},
      { id: 14, phase: 4, title: 'تدريب عملي ميداني (1) – التقييم داخل المنشآت', iconKey: 'field', imageUrl: '', topics: [
        'تطبيق معايير التميز داخل منشآت مختارة','مراجعة الممارسات مقابل معايير KAQA','استخدام أداة إتقان ميدانيًا','رصد نقاط القوة وفرص التحسين'
      ]},
      { id: 15, phase: 4, title: 'تدريب عملي ميداني (2) – التحليل وبناء التحسين', iconKey: 'analysis', imageUrl: '', topics: [
        'تحليل مخرجات التقييم الميداني','ربط الملاحظات بالمعايير والممكنات','اقتراح فرص تحسين واقعية وقابلة للتنفيذ','إعداد ملخص النتائج (Summary Findings)'
      ]},
      { id: 16, phase: 4, title: 'اللقاء الختامي – التكريم واستدامة الأثر', iconKey: 'closing', imageUrl: '', topics: [
        'استعراض نتائج التدريب الميداني','مشاركة تجارب وقصص تطبيقية','دور سفراء التميز في نقل الأثر داخل المنشآت','تكريم المشاركين'
      ]}
    ];

    /* ✅ أسماء المراحل حسب اللي إنت بعته حرفيًا */
    const phaseNames = { 1:'التأسيسية', 2:'بناء المفاهيم', 3:'التقييم والنتايج', 4:'التطبيق العملي' };

    /* ===================== STATE ===================== */
    let currentPhase = 'all';
    let selectedId = 1;
    let openId = 1;

    function scrollToContent(){
      const el = document.getElementById('filters');
      if (el) el.scrollIntoView({ behavior:'smooth', block:'start' });
    }

    function setActiveTab(phase){
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('tab-active'));
      const active = document.getElementById(`tab-${phase}`);
      if (active) active.classList.add('tab-active');
    }

    function filteredSessions(){
      return currentPhase === 'all' ? sessions : sessions.filter(s => s.phase === currentPhase);
    }

    function getProgressIndex(list, id){
      return list.findIndex(x => x.id === id);
    }

    /* ===================== RENDER ===================== */
    function renderTimeline(){
      const root = document.getElementById('timeline');
      const list = filteredSessions();
      const progIdx = getProgressIndex(list, selectedId);

      root.innerHTML = list.map((s, i) => {
        const active = selectedId === s.id;
        const isOpen = openId === s.id;

        const sessionText = `اللقاء ${s.id}`;
        const phaseText = `${phaseNames[s.phase]}`;

        /* ✅ الأيقونات اتشالت: bgIcon فاضي */
        const bgIcon = ``;

        const chevron = `
          <div class="chev" title="فتح التفاصيل">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 9l6 6 6-6"/>
            </svg>
          </div>
        `;

        const card = `
          <div class="t-card ${active ? 'active' : ''} ${isOpen ? 'open' : ''}"
               onclick="toggleOpen(${s.id})" id="card-${s.id}">
            ${bgIcon}
            <div class="card-head">
              <div class="card-main">
                <div class="card-text-col card-text-shift">
                  <div class="card-text-top">
                    <div class="head-icon" aria-hidden="true">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <path d="M12 2l3.2 6.5L22 9.3l-5 4.8 1.2 6.9L12 17.8l-6.2 3.3L7 14.1 2 9.3l6.9-0.8L12 2z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path>
                      </svg>
                    </div>
                    <div class="card-meta">
                      <div class="meta-row">
                        <span class="pill pill-session">${sessionText}</span>
                        <span class="pill pill-phase">${phaseText}</span>
                      </div>
                    </div>
                    ${chevron}
                  </div>
                  <div class="card-text">
                    <div class="card-title">${s.title}</div>
                    <div class="card-sub">${s.topics.length} محاور تدريبية</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="details">
              <div class="p-4">
                <div class="details-grid">
                  <div class="details-media">
                    <img src="${s.id}.png" alt="صورة اللقاء ${s.id}" loading="lazy" decoding="async" />
                  </div>
                  <div class="details-topics">
                    <h4 class="font-extrabold text-slate-800 mb-3 text-sm">المحاور التدريبية:</h4>
                    <ul class="space-y-2">
                      ${s.topics.map(t => `
                        <li class="flex items-start gap-2 text-sm text-slate-700">
                          <span class="bullet-check" aria-hidden="true">
                            <svg fill="none" viewBox="0 0 24 24">
                              <path d="M20 6L9 17l-5-5" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                          </span>
                          <span>${t}</span>
                        </li>
                      `).join('')}
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;

        return `
          <div class="t-item">
            ${card}
          </div>
        `;
      }).join('');
    }

    /* ===================== INTERACTIONS ===================== */
    function setCheckpoint(id){
      selectedId = id;
      renderTimeline();
      const el = document.getElementById(`card-${id}`);
      if (el) setTimeout(() => el.scrollIntoView({ behavior:'smooth', block:'center' }), 60);
    }

    function toggleOpen(id){
      openId = (openId === id) ? null : id;
      selectedId = id;
      renderTimeline();
      const el = document.getElementById(`card-${id}`);
      if (el) setTimeout(() => el.scrollIntoView({ behavior:'smooth', block:'center' }), 60);
    }

    async function showPhase(phase){
      currentPhase = phase;
      setActiveTab(phase);

      const wrap = document.getElementById('timelineWrap');
      wrap.classList.add('is-switching');

      await new Promise(r => setTimeout(r, 240));

      const list = filteredSessions();
      if (!list.some(x => x.id === selectedId)) selectedId = list[0]?.id ?? 1;
      if (!list.some(x => x.id === openId)) openId = selectedId;

      renderTimeline();
      requestAnimationFrame(() => wrap.classList.remove('is-switching'));
    }

    /* ===================== SDK hooks ===================== */
    async function onConfigChange(config) {
      const titleEl = document.getElementById('program-title');
      const badgeEl = document.getElementById('sessions-badge');

      if (titleEl) titleEl.textContent = config.program_title || defaultConfig.program_title;
      if (badgeEl) badgeEl.textContent = (config.sessions_count || defaultConfig.sessions_count) + ' تدريبياً';
    }
    function mapToCapabilities(config) {
      return {
        recolorables: [
          { get: () => config.primary_color || defaultConfig.primary_color, set: v => window.elementSdk.setConfig({ primary_color: v }) },
          { get: () => config.secondary_color || defaultConfig.secondary_color, set: v => window.elementSdk.setConfig({ secondary_color: v }) },
          { get: () => config.accent_color || defaultConfig.accent_color, set: v => window.elementSdk.setConfig({ accent_color: v }) },
        ],
        borderables: [],
        fontEditable: { get: () => config.font_family || 'Tajawal', set: v => window.elementSdk.setConfig({ font_family: v }) },
        fontSizeable: { get: () => config.font_size || 16, set: v => window.elementSdk.setConfig({ font_size: v }) }
      };
    }
    function mapToEditPanelValues(config) {
      return new Map([
        ['program_title', config.program_title || defaultConfig.program_title],
        ['sessions_count', config.sessions_count || defaultConfig.sessions_count]
      ]);
    }
    if (window.elementSdk) {
      window.elementSdk.init({ defaultConfig, onConfigChange, mapToCapabilities, mapToEditPanelValues });
    }

    /* ===================== NETWORK (FIXED: never stops) ===================== */
    function startNetwork(canvasId, opts = {}) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      const ctx = canvas.getContext('2d');

      const config = {
        count: opts.count ?? 84,
        maxDist: opts.maxDist ?? 210,
        speed: opts.speed ?? 0.55,
        dot: opts.dot ?? 2.0,
        line: opts.line ?? 1.2,
        dotAlpha: opts.dotAlpha ?? 0.65,
        lineAlpha: opts.lineAlpha ?? 0.24,
        mouseForce: opts.mouseForce ?? 0.012,
        mouseRadius: opts.mouseRadius ?? 260,
        jitter: opts.jitter ?? 0.0010,
        maxV: opts.maxV ?? 1.10
      };

      let w=0, h=0, dpr=1;
      let particles = [];
      let mouse = { x: -9999, y: -9999, active: false };

      function rand(min, max){ return min + Math.random()*(max-min); }

      function resize() {
        dpr = Math.max(1, window.devicePixelRatio || 1);
        w = canvas.clientWidth;
        h = canvas.clientHeight;
        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        particles = Array.from({ length: config.count }).map(() => ({
          x: Math.random() * w,
          y: Math.random() * h,
          vx: rand(-config.speed, config.speed),
          vy: rand(-config.speed, config.speed)
        }));
      }

      function keepAlive(p){
        const v = Math.sqrt(p.vx*p.vx + p.vy*p.vy);
        if (v < 0.08){
          p.vx += rand(-0.25, 0.25);
          p.vy += rand(-0.25, 0.25);
        }
        p.vx = Math.max(-config.maxV, Math.min(config.maxV, p.vx));
        p.vy = Math.max(-config.maxV, Math.min(config.maxV, p.vy));
      }

      function step() {
        ctx.clearRect(0,0,w,h);

        for (const p of particles) {
          if (mouse.active) {
            const dx = mouse.x - p.x;
            const dy = mouse.y - p.y;
            const dist = Math.sqrt(dx*dx + dy*dy);
            if (dist < config.mouseRadius && dist > 0.0001) {
              const pull = (1 - dist / config.mouseRadius) * config.mouseForce;
              p.vx += (dx / dist) * pull;
              p.vy += (dy / dist) * pull;
            }
          }

          p.vx += rand(-config.jitter, config.jitter);
          p.vy += rand(-config.jitter, config.jitter);

          p.vx *= 0.996;
          p.vy *= 0.996;

          keepAlive(p);

          p.x += p.vx;
          p.y += p.vy;

          if (p.x < -10) p.x = w + 10;
          if (p.x > w + 10) p.x = -10;
          if (p.y < -10) p.y = h + 10;
          if (p.y > h + 10) p.y = -10;
        }

        for (let i=0;i<particles.length;i++){
          for (let j=i+1;j<particles.length;j++){
            const a = particles[i], b = particles[j];
            const dx = a.x - b.x, dy = a.y - b.y;
            const dist = Math.sqrt(dx*dx + dy*dy);
            if (dist < config.maxDist){
              const t = 1 - (dist / config.maxDist);
              ctx.strokeStyle = `rgba(255,255,255,${config.lineAlpha * t})`;
              ctx.lineWidth = config.line;
              ctx.beginPath();
              ctx.moveTo(a.x, a.y);
              ctx.lineTo(b.x, b.y);
              ctx.stroke();
            }
          }
        }

        for (const p of particles){
          ctx.fillStyle = `rgba(255,255,255,${config.dotAlpha})`;
          ctx.beginPath();
          ctx.arc(p.x, p.y, config.dot, 0, Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(step);
      }

      function onMove(e){
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
        mouse.active = true;
      }
      function onLeave(){ mouse.active = false; }

      canvas.addEventListener('mousemove', onMove, { passive:true });
      canvas.addEventListener('mouseleave', onLeave, { passive:true });
      window.addEventListener('resize', resize);

      resize();
      step();
    }

    /* init */
    setActiveTab('all');
    renderTimeline();

    startNetwork('heroNetwork',   { count: 84, maxDist: 210, speed: 0.55, dot: 2.0, line: 1.2, lineAlpha: 0.24, mouseForce: 0.012, mouseRadius: 260, jitter: 0.0010 });
    startNetwork('footerNetwork', { count: 52, maxDist: 180, speed: 0.38, dot: 1.6, line: 1.0, lineAlpha: 0.18, mouseForce: 0.008, mouseRadius: 220, jitter: 0.0008 });

    (function initScrollProgress(){
      const wrap = document.getElementById('scrollProgress');
      if (!wrap) return;
      const bar = wrap.querySelector('.scroll-progress__bar');
      const scroller = document.getElementById('app-wrapper') || document.documentElement;

      function getScrollMetrics(){
        // If app-wrapper is the scrolling container:
        if (scroller && scroller.id === 'app-wrapper'){
          const max = scroller.scrollHeight - scroller.clientHeight;
          const y = scroller.scrollTop;
          return { y, max };
        }
        // Fallback to window scrolling:
        const y = window.scrollY || document.documentElement.scrollTop || 0;
        const max = (document.documentElement.scrollHeight - window.innerHeight);
        return { y, max };
      }

      function update(){
        const { y, max } = getScrollMetrics();
        const pct = max > 0 ? Math.max(0, Math.min(1, y / max)) : 0;
        bar.style.width = (pct * 100).toFixed(2) + '%';
        wrap.classList.toggle('is-zero', pct < 0.02);
      }

      // smooth but light
      let raf = null;
      function onScroll(){
        if (raf) return;
        raf = requestAnimationFrame(() => {
          raf = null;
          update();
        });
      }

      update();

      // bind to correct scroller
      if (scroller && scroller.id === 'app-wrapper'){
        scroller.addEventListener('scroll', onScroll, { passive:true });
      } else {
        window.addEventListener('scroll', onScroll, { passive:true });
      }
      window.addEventListener('resize', onScroll, { passive:true });
    })();
  </script>
</body>
</html>
